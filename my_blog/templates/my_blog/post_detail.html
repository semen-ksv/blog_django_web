{% extends 'my_blog/blog_base.html' %}

{% block title %}
    {{ post.title }}
{% endblock %}


{% block content %}

    <div class="media-body">
        <div class="media-article">
            <h2>{{ post.title }}</h2>
            <div class="article-metadata" style="margin-top: 20px; margin-bottom: 20px;">
                <div class="article-head-img">
                    <img class="rounded-circle" src="{{ post.author.profile.image.url }}" width="50" height="50">
                </div>
                <a class="mr-2" href="{% url 'author_post' post.author.username %}">{{ post.author }}</a>
                <small class="text-muted">{{ post.date_posted }}</small>
            </div>

            <div class="article-content">
                {% if post.post_img %}
                    <img src="{{ post.post_img.url }}"
                         style="float:left; margin: 0 7px 7px 0; max-height:100%!important;">
                {% endif %}
                {{ post.body }}
            </div>
            <div style="color: #f5efaf; float: right; font-size: 12px">post have {{ post.comment_count }} comments</div>
            <div style="clear:both;">
                {% for tag in post.tags.all %}
                    <a href="{% url 'tags_list' %}" class="badge badge-pill badge-dark">{{ tag }}</a>
                {% endfor %}
            </div>

        </div>
    </div>
    <br>

    {% if user.is_authenticated and post.author == user or user.is_staff %}

        <div style="padding: 0 10% 0 10%; display: flex; justify-content: space-between; align-items: center;">
            <a type="button" class="btn btn-outline-info" href="{{ post.get_update_url }}">
                Change post
            </a>

            <a type="submit" class="btn btn-outline-danger" style="" href="{% url 'post_delete' slug=post.slug %}">
                Delete post
            </a>
        </div>

    {% endif %}
    <div class="post_comment">
        <p><h4>Live your comment</h4></p>
        <form action="{% url 'post_comment' post.id %}" method="post">
            {% csrf_token %}

            <div class="form-group">
            <textarea id="comment_text" name="body" cols="70" rows="4" placeholder="Write comment">
            </textarea>


                <div style="padding: 0 0 0 60%;">
                    {% if user.is_authenticated %}
                        <button type="submit" class="btn btn-outline-info" style="">
                            Add Comment
                        </button>
                        {% else %}
                        <a class="ml-2" href="{% url 'login'  %}"><strong style="color: #055865;">Log In to live a comment</strong></a>
                    {% endif %}

                </div>
            </div>
        </form>
    </div>
    {% for comment in post.get_comments %}
        <div class="media-body-comment">
            <div class="media-comment">
                <div class="article-metadata" style="margin-top: 20px; margin-bottom: 20px;">
                    <div class="article-head-img">
                        <img class="rounded-circle" src="{{ comment.user.profile.image.url }}" width="30" height="30">
                    </div>
                    <a class="mr-2" href="">{{ comment.user }}</a>
                    <small class="text-muted">{{ comment.date_comment }}</small>
                </div>

                <div class="article-content">
                    {{ comment.body }}
                </div>
            </div>
        </div>
    {% endfor %}

{% endblock %}
